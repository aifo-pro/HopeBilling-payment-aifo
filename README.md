# Модуль оплати AIFO для HopeBilling

Модуль оплати AIFO призначений для приймання платежів через платіжну систему AIFO в системі управління хостингом HopeBilling. Модуль інтегрується з платіжною підсистемою HopeBilling та забезпечує формування платіжних запитів, обробку callback-повідомлень, маршрутизацію платіжних подій і перевірку підпису платежів.

Для коректної роботи модуля необхідно використовувати HopeBilling версії 2.x або новішої, PHP версії 7.2 або новішої, а також встановлений Composer для керування залежностями. Після встановлення модуля рекомендується перевірити коректність автозавантаження класів та очистити кеш системи.

Перед початком встановлення файли модуля необхідно завантажити та розмістити у файловій системі HopeBilling. Каталог модуля aifo слід скопіювати до директорії /app/modules/. Після копіювання перевірте, що структура каталогу /app/modules/aifo/ містить файли aifo.php, routes.php, класи платіжного API у каталозі classes/payment/AIFOAPI.php, контролери AIFOController.php та AIFOStatusController.php у каталозі controllers/front/, а також шаблони template/front/default/bill/pay.php і template/admin/default/setting.php. За потреби очистіть кеш, видаливши файли з каталогу /app/cache/.

Після встановлення файлів виконайте налаштування модуля в адміністративній панелі HopeBilling. Для цього увійдіть до панелі керування, перейдіть у розділ «Модулі», відкрийте список платіжних систем, знайдіть модуль AIFO та перейдіть до його налаштувань. У параметрах модуля необхідно вказати ідентифікатор магазину (shop_id) та секретний ключ (secret_key), отримані в особистому кабінеті платіжної системи AIFO в розділі налаштувань магазину. Секретний ключ зберігається в зашифрованому вигляді.

У параметрі типу підпису (signature_type) необхідно вказати алгоритм хешування, що використовується в особистому кабінеті AIFO. Підтримуються такі значення: 1 — MD5, 2 — SHA256, 3 — SHA1, 4 — RIPEMD160, 5 — SHA384, 6 — SHA512. Значення параметра повинно повністю відповідати налаштуванням платіжної системи AIFO.

У параметрі URL сервісу AIFO зазначається адреса платіжного сервісу. За замовчуванням використовується https://test.aifo.pro. За необхідності може бути вказаний production URL, наданий платіжною системою.

Для отримання повідомлень про результати платежів у налаштуваннях модуля необхідно вказати URL обробника callback у форматі http://ваш-домен/modules/aifo/status, де ваш-домен — доменне ім’я сервера з установленим HopeBilling. Рекомендується використовувати захищене з’єднання HTTPS та забезпечити доступність зазначеного URL з мережі Інтернет.

Формування підпису платіжного запиту виконується за формулою hash(shop_id:amount:secret_key:id), де shop_id — ідентифікатор магазину, amount — сума платежу, secret_key — секретний ключ, id — ідентифікатор рахунку. Тип функції хешування визначається значенням параметра signature_type.

Під час обробки callback-повідомлень виконується перевірка підпису за формулою hash(shop_id:sum:secret_key:invoice), де sum — сума платежу з callback-повідомлення, invoice — ідентифікатор інвойсу. Отриманий підпис порівнюється зі значенням http_auth_signature.

Під час встановлення модуль автоматично реєструє маршрути /modules/aifo/status, який використовується як обробник callback-повідомлень платіжної системи, та /modules/aifo/result, який використовується для відображення результату оплати користувачу.

Модуль підтримує всі типи підписів, доступні в платіжній системі AIFO. Тип підпису в налаштуваннях модуля повинен збігатися з типом підпису, зазначеним в особистому кабінеті AIFO. У разі виникнення помилок рекомендується перевірити коректність параметрів, доступність callback URL, права доступу до файлів модуля та виконати перезавантаження веб-сервера. Для директорій рекомендується використовувати права доступу 755, для файлів — 644.

Інформація про платіжну систему та технічна підтримка доступні на офіційному сайті https://aifo.pro, у документації https://aifo.pro/docs та через Telegram @aifo_bot.

Версія модуля: AIFO Payment Module for HopeBilling v1.0. © 2026 AIFO.PRO.
